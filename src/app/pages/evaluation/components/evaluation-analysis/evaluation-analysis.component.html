<!-- Button -->
<div class="fixed top-4 right-4 z-50">
  <button
    pTooltip="An치lisis IA"
    tooltipPosition="left"
    class="text-primary-500 dark:bg-bunker-900 dark:hover:bg-bunker-950/30 dark:border-bunker-800/75 flex cursor-pointer items-center justify-center rounded-full border border-gray-300 bg-white p-2 transition-colors duration-200 ease-in-out hover:bg-gray-300"
    (click)="showDialog()">
    <ng-icon name="lucideSparkles" size="20" />
  </button>
</div>
<!-- Dialog -->
<p-dialog
  header="游뱄 An치lisis (IA)"
  [modal]="true"
  [(visible)]="visible"
  styleClass="w-full max-w-5xl">
  <div
    class="mb-4 flex items-center justify-center gap-4 py-5 text-gray-800 dark:text-gray-300">
    @if (isLoading()) {
      <div class="flex w-full flex-col items-center justify-center">
        <app-spinner />
        <h3>Cargando an치lisis...</h3>
      </div>
    } @else {
      @if (analysis()) {
        <!-- Tabs -->
        <p-tabs value="0">
          <p-tablist>
            <p-tab value="0">Vista Ejecutiva</p-tab>
            <p-tab value="1">Vista Operativa</p-tab>
          </p-tablist>

          <p-tabpanels>
            <!-- TAB 1 -->
            <p-tabpanel value="0">
              <markdown
                [data]="analysis()?.executive_view"
                class="prose dark:prose-invert max-w-none"></markdown>
            </p-tabpanel>

            <!-- TAB 2 -->
            <p-tabpanel value="1">
              <pre
                class="overflow-auto rounded-xl bg-gray-900 p-4 text-green-300">
                {{ analysis()?.operative_view }}
                </pre
              >
            </p-tabpanel>
          </p-tabpanels>
        </p-tabs>
      } @else {
        <p class="italic">
          El an치lisis est치 en proceso o no se encuentra disponible...
        </p>
      }
    }
  </div>

  <div class="flex justify-end gap-2">
    <p-button label="Cerrar" severity="secondary" (click)="hiddenDialog()" />
  </div>
</p-dialog>
