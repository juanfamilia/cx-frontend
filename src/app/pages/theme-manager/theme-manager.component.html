<div class="theme-manager p-6">
  <div class="header mb-6">
    <div class="flex justify-between items-center">
      <div>
        <h1 class="text-3xl font-bold text-gray-800">Gestor de Temas (White-Label)</h1>
        <p class="text-gray-600 mt-2">Personaliza la apariencia de tu plataforma</p>
      </div>
      <button *ngIf="!isEditing && theme" 
              (click)="startEdit()" 
              class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-semibold">
        Editar Tema
      </button>
    </div>
  </div>

  <div *ngIf="loading" class="flex justify-center items-center h-64">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
  </div>

  <div *ngIf="!loading">
    <!-- View Mode -->
    <div *ngIf="!isEditing && theme" class="bg-white rounded-lg shadow p-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h3 class="text-xl font-bold text-gray-800 mb-4">Colores</h3>
          <div class="space-y-3">
            <div class="flex items-center gap-4">
              <div class="w-24 text-sm text-gray-600">Primario:</div>
              <div class="flex items-center gap-2">
                <div [style.backgroundColor]="theme.primary_color" 
                     class="w-12 h-12 rounded border"></div>
                <span class="font-mono text-sm">{{ theme.primary_color }}</span>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <div class="w-24 text-sm text-gray-600">Secundario:</div>
              <div class="flex items-center gap-2">
                <div [style.backgroundColor]="theme.secondary_color" 
                     class="w-12 h-12 rounded border"></div>
                <span class="font-mono text-sm">{{ theme.secondary_color }}</span>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <div class="w-24 text-sm text-gray-600">Acento:</div>
              <div class="flex items-center gap-2">
                <div [style.backgroundColor]="theme.accent_color" 
                     class="w-12 h-12 rounded border"></div>
                <span class="font-mono text-sm">{{ theme.accent_color }}</span>
              </div>
            </div>
          </div>
        </div>

        <div>
          <h3 class="text-xl font-bold text-gray-800 mb-4">Tipografía</h3>
          <div class="space-y-3">
            <div>
              <div class="text-sm text-gray-600">Fuente:</div>
              <div [style.fontFamily]="theme.font_family" class="text-lg mt-1">
                {{ theme.font_family || 'Por defecto' }}
              </div>
            </div>
          </div>
        </div>

        <div>
          <h3 class="text-xl font-bold text-gray-800 mb-4">Recursos</h3>
          <div class="space-y-3">
            <div>
              <div class="text-sm text-gray-600">Logo URL:</div>
              <div class="text-sm mt-1">{{ theme.logo_url || 'No configurado' }}</div>
            </div>
            <div>
              <div class="text-sm text-gray-600">Favicon URL:</div>
              <div class="text-sm mt-1">{{ theme.favicon_url || 'No configurado' }}</div>
            </div>
          </div>
        </div>

        <div>
          <h3 class="text-xl font-bold text-gray-800 mb-4">Estado</h3>
          <span [ngClass]="theme.is_active ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'"
                class="inline-block px-3 py-1 rounded-full text-sm">
            {{ theme.is_active ? 'Activo' : 'Inactivo' }}
          </span>
        </div>
      </div>

      <div *ngIf="theme.custom_css" class="mt-6">
        <h3 class="text-xl font-bold text-gray-800 mb-4">CSS Personalizado</h3>
        <div class="bg-gray-50 p-4 rounded border font-mono text-sm whitespace-pre-wrap">
          {{ theme.custom_css }}
        </div>
      </div>
    </div>

    <!-- Edit Mode -->
    <div *ngIf="isEditing" class="bg-white rounded-lg shadow p-6">
      <form (ngSubmit)="saveTheme()" class="space-y-6">
        <div>
          <h3 class="text-xl font-bold text-gray-800 mb-4">Colores</h3>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div>
              <label class="text-sm font-semibold text-gray-700">Color Primario</label>
              <div class="flex items-center gap-2 mt-2">
                <input [(ngModel)]="form.primary_color" 
                       name="primary_color"
                       type="color" 
                       class="h-10 w-20 rounded border cursor-pointer">
                <input [(ngModel)]="form.primary_color" 
                       name="primary_color_text"
                       type="text" 
                       class="flex-1 border rounded px-3 py-2 font-mono text-sm">
              </div>
            </div>
            <div>
              <label class="text-sm font-semibold text-gray-700">Color Secundario</label>
              <div class="flex items-center gap-2 mt-2">
                <input [(ngModel)]="form.secondary_color" 
                       name="secondary_color"
                       type="color" 
                       class="h-10 w-20 rounded border cursor-pointer">
                <input [(ngModel)]="form.secondary_color" 
                       name="secondary_color_text"
                       type="text" 
                       class="flex-1 border rounded px-3 py-2 font-mono text-sm">
              </div>
            </div>
            <div>
              <label class="text-sm font-semibold text-gray-700">Color de Acento</label>
              <div class="flex items-center gap-2 mt-2">
                <input [(ngModel)]="form.accent_color" 
                       name="accent_color"
                       type="color" 
                       class="h-10 w-20 rounded border cursor-pointer">
                <input [(ngModel)]="form.accent_color" 
                       name="accent_color_text"
                       type="text" 
                       class="flex-1 border rounded px-3 py-2 font-mono text-sm">
              </div>
            </div>
          </div>
        </div>

        <div>
          <h3 class="text-xl font-bold text-gray-800 mb-4">Tipografía</h3>
          <div>
            <label class="text-sm font-semibold text-gray-700">Familia de Fuente</label>
            <select [(ngModel)]="form.font_family" 
                    name="font_family"
                    class="w-full border rounded px-3 py-2 mt-2">
              <option *ngFor="let font of fontOptions" [value]="font">{{ font }}</option>
            </select>
          </div>
        </div>

        <div>
          <h3 class="text-xl font-bold text-gray-800 mb-4">Recursos</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="text-sm font-semibold text-gray-700">URL del Logo</label>
              <input [(ngModel)]="form.logo_url" 
                     name="logo_url"
                     type="url" 
                     placeholder="https://example.com/logo.png"
                     class="w-full border rounded px-3 py-2 mt-2">
            </div>
            <div>
              <label class="text-sm font-semibold text-gray-700">URL del Favicon</label>
              <input [(ngModel)]="form.favicon_url" 
                     name="favicon_url"
                     type="url" 
                     placeholder="https://example.com/favicon.ico"
                     class="w-full border rounded px-3 py-2 mt-2">
            </div>
          </div>
        </div>

        <div>
          <h3 class="text-xl font-bold text-gray-800 mb-4">CSS Personalizado</h3>
          <textarea [(ngModel)]="form.custom_css" 
                    name="custom_css"
                    rows="6"
                    placeholder="/* CSS personalizado aquí */"
                    class="w-full border rounded px-3 py-2 font-mono text-sm"></textarea>
        </div>

        <div class="flex items-center gap-2">
          <input [(ngModel)]="form.is_active" 
                 name="is_active"
                 type="checkbox" 
                 id="is_active_edit" 
                 class="h-4 w-4">
          <label for="is_active_edit" class="text-sm font-semibold text-gray-700">Tema Activo</label>
        </div>

        <div class="flex gap-3 pt-4">
          <button type="submit" 
                  class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg">
            Guardar Cambios
          </button>
          <button type="button" 
                  (click)="previewTheme()" 
                  class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg">
            Vista Previa
          </button>
          <button type="button" 
                  (click)="resetToDefault()" 
                  class="bg-gray-400 hover:bg-gray-500 text-white px-6 py-2 rounded-lg">
            Restaurar Defecto
          </button>
          <button type="button" 
                  (click)="cancelEdit()" 
                  class="bg-gray-300 hover:bg-gray-400 text-gray-800 px-6 py-2 rounded-lg">
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
